D:\Anaconda\envs\DL\python.exe D:\PyCharm\Py_Projects\school\school_100\任务二\run_train.py
======== 实验配置 ========
使用设备: cuda
批次大小: 32
权重衰减: 0.0001
阶段一 Epochs: 15, 学习率: 0.001
阶段二 Epochs: 10, 学习率: 5e-06
==========================

[1/4] 正在加载和划分数据...
总数据集大小: 3670
新训练集大小: 2936 (Stage 1: 2055, Stage 2: 881)
新验证集大小: 367
新测试集大小: 367

[2/4] 正在加载预训练的 AlexNet 模型...
模型加载完成。

[3/4] 开始执行第一阶段训练...

--- 开始第一阶段训练: 仅训练全连接层 ---

Stage 1 - Epoch 1/15:
  Train Loss: 0.3085, Train Acc: 0.9562
  Val Loss:   0.2374, Val Acc:   0.9619✨✨✨✨✨✨✨✨✨✨✨✨
训练中:   0%|          | 0/65 [00:00<?, ?it/s]  -> 验证Loss改善，模型已保存至 D:\PyCharm\Py_Projects\school\school_100\任务二\best_model_stage1.pth

Stage 1 - Epoch 2/15:
训练中:   0%|          | 0/65 [00:00<?, ?it/s]  Train Loss: 0.1229, Train Acc: 0.9674
  Val Loss:   0.2567, Val Acc:   0.9564

Stage 1 - Epoch 3/15:
训练中:   0%|          | 0/65 [00:00<?, ?it/s]  Train Loss: 0.0895, Train Acc: 0.9718
  Val Loss:   0.2624, Val Acc:   0.9482

Stage 1 - Epoch 4/15:
  Train Loss: 0.0709, Train Acc: 0.9771
  Val Loss:   0.2849, Val Acc:   0.9482
  Early stopping 触发于 epoch 4.✨✨✨✨✨✨✨✨✨✨✨✨

加载第一阶段最佳模型 (来自 Epoch 1)...✨✨✨✨✨✨✨✨✨✨✨✨

[可视化] 正在创建第一阶段训练曲线图...
评估中:   0%|          | 0/12 [00:00<?, ?it/s]
--- 在测试集上评估 第一阶段 模型 ---✨✨✨✨✨✨✨✨✨✨✨✨
训练中:   0%|          | 0/28 [00:00<?, ?it/s]测试结果 - Loss: 0.3166, Accuracy: 0.9510✨✨✨✨✨✨✨✨✨✨✨✨

[4/4] 开始执行第二阶段训练...

--- 开始第二阶段训练: 微调部分解冻层 ---
解冻模型分类器层 (model.classifier)...

Stage 2 - Epoch 1/10:
  Train Loss: 0.2515, Train Acc: 0.9682
  Val Loss:   0.2470, Val Acc:   0.9619
训练中:   0%|          | 0/28 [00:00<?, ?it/s]  -> S2 验证Loss改善，模型已保存至 D:\PyCharm\Py_Projects\school\school_100\任务二\best_model_stage2.pth

Stage 2 - Epoch 2/10:
  Train Loss: 0.2352, Train Acc: 0.9682
  Val Loss:   0.2410, Val Acc:   0.9619
训练中:   0%|          | 0/28 [00:00<?, ?it/s]  -> S2 验证Loss改善，模型已保存至 D:\PyCharm\Py_Projects\school\school_100\任务二\best_model_stage2.pth

Stage 2 - Epoch 3/10:
  Train Loss: 0.2115, Train Acc: 0.9682
  Val Loss:   0.2312, Val Acc:   0.9619
  -> S2 验证Loss改善，模型已保存至 D:\PyCharm\Py_Projects\school\school_100\任务二\best_model_stage2.pth

Stage 2 - Epoch 4/10:
  Train Loss: 0.2142, Train Acc: 0.9682
  Val Loss:   0.2238, Val Acc:   0.9619
  -> S2 验证Loss改善，模型已保存至 D:\PyCharm\Py_Projects\school\school_100\任务二\best_model_stage2.pth

Stage 2 - Epoch 5/10:
  Train Loss: 0.1675, Train Acc: 0.9671
  Val Loss:   0.2226, Val Acc:   0.9619
  -> S2 验证Loss改善，模型已保存至 D:\PyCharm\Py_Projects\school\school_100\任务二\best_model_stage2.pth

Stage 2 - Epoch 6/10:
训练中:   0%|          | 0/28 [00:00<?, ?it/s]  Train Loss: 0.1628, Train Acc: 0.9682
  Val Loss:   0.2249, Val Acc:   0.9619

Stage 2 - Epoch 7/10:
训练中:   0%|          | 0/28 [00:00<?, ?it/s]  Train Loss: 0.1576, Train Acc: 0.9682
  Val Loss:   0.2271, Val Acc:   0.9619

Stage 2 - Epoch 8/10:
训练中:   0%|          | 0/28 [00:00<?, ?it/s]  Train Loss: 0.1494, Train Acc: 0.9694
  Val Loss:   0.2294, Val Acc:   0.9619

Stage 2 - Epoch 9/10:
训练中:   0%|          | 0/28 [00:00<?, ?it/s]  Train Loss: 0.1373, Train Acc: 0.9682
  Val Loss:   0.2320, Val Acc:   0.9619

Stage 2 - Epoch 10/10:
  Train Loss: 0.1308, Train Acc: 0.9682
  Val Loss:   0.2334, Val Acc:   0.9619✨✨✨✨✨✨✨✨✨✨✨✨

加载第二阶段最佳模型...

[可视化] 正在创建包含所有阶段的最终训练曲线图...

--- 在测试集上评估 第二阶段（最终） 模型 ---
测试结果 - Loss: 0.2912, Accuracy: 0.9510✨✨✨✨✨✨✨✨✨✨✨✨

--- 任务完成 ---

进程已结束，退出代码为 0
