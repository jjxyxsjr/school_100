D:\Anaconda\envs\DL\python.exe D:\PyCharm\Py_Projects\school\school_100\任务二\VGG\run_train.py
项目启动...
使用的设备是: cuda
数据集目录 'data_split' 已存在，跳过重新划分。
类别: ['daisy', 'dandelion', 'roses', 'sunflowers', 'tulips']
数据加载完毕。训练集大小: 2936, 验证集大小: 367, 测试集大小: 367
模型已加载并移动到: cuda

--- 开始训练阶段 1 ---
Epochs: 15, LR: 0.001, Weight Decay: 0.0001
Epoch 1/15
----------
训练 Loss: 1.0098 Acc: 0.7122
验证 Loss: 0.5610 Acc: 0.8556
验证集损失从 inf 降低到 0.5610。保存模型...
Epoch 2/15
----------
训练 Loss: 0.6251 Acc: 0.8151
验证 Loss: 0.5977 Acc: 0.8692
验证集损失没有改善，计数: 1/3
Epoch 3/15
----------
训练 Loss: 0.6101 Acc: 0.8212
验证 Loss: 0.5617 Acc: 0.8583
验证集损失没有改善，计数: 2/3
Epoch 4/15
----------
训练 Loss: 0.5312 Acc: 0.8334
验证 Loss: 0.5341 Acc: 0.8583
验证集损失从 0.5610 降低到 0.5341。保存模型...
Epoch 5/15
----------
训练 Loss: 0.5816 Acc: 0.8317
验证 Loss: 0.5189 Acc: 0.8692
验证集损失从 0.5341 降低到 0.5189。保存模型...
Epoch 6/15
----------
训练 Loss: 0.5110 Acc: 0.8556
验证 Loss: 0.4418 Acc: 0.8828
验证集损失从 0.5189 降低到 0.4418。保存模型...
Epoch 7/15
----------
训练 Loss: 0.4566 Acc: 0.8590
验证 Loss: 0.3447 Acc: 0.8910
验证集损失从 0.4418 降低到 0.3447。保存模型...
Epoch 8/15
----------
训练 Loss: 0.5020 Acc: 0.8593
验证 Loss: 0.4316 Acc: 0.8883
验证集损失没有改善，计数: 1/3
Epoch 9/15
----------
训练 Loss: 0.5063 Acc: 0.8593
验证 Loss: 0.4141 Acc: 0.9046
验证集损失没有改善，计数: 2/3
Epoch 10/15
----------
训练 Loss: 0.6118 Acc: 0.8413
验证 Loss: 0.4473 Acc: 0.8883
验证集损失没有改善，计数: 3/3
触发 Early Stopping!
训练阶段 1 完成，耗时 7分 31秒
最佳验证集 Acc: 0.891008
训练可视化图表已保存至: training_results_stage1.png

--- 评估第一阶段模型在测试集上的表现 ---

--- 在测试集上评估最终模型 ---
测试集上的准确率: 0.8420🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟
模型的部分卷积层和所有分类层已解冻用于微调。

--- 开始训练阶段 2 ---
Epochs: 10, LR: 5e-05, Weight Decay: 0.0001
已从 best_model_stage1.pth 加载模型权重。
Epoch 1/10
----------
训练 Loss: 0.4023 Acc: 0.8658
验证 Loss: 0.2467 Acc: 0.9292
验证集损失从 inf 降低到 0.2467。保存模型...
Epoch 2/10
----------
训练 Loss: 0.2732 Acc: 0.9101
验证 Loss: 0.1805 Acc: 0.9401
验证集损失从 0.2467 降低到 0.1805。保存模型...
Epoch 3/10
----------
训练 Loss: 0.2565 Acc: 0.9193
验证 Loss: 0.2449 Acc: 0.9319
验证集损失没有改善，计数: 1/3
Epoch 4/10
----------
训练 Loss: 0.2418 Acc: 0.9206
验证 Loss: 0.2919 Acc: 0.9046
验证集损失没有改善，计数: 2/3
Epoch 5/10
----------
训练 Loss: 0.2318 Acc: 0.9254
验证 Loss: 0.2553 Acc: 0.9319
验证集损失没有改善，计数: 3/3
触发 Early Stopping!
训练阶段 2 完成，耗时 7分 44秒
最佳验证集 Acc: 0.940054
训练可视化图表已保存至: training_results_stage2.png

--- 评估第二阶段模型在测试集上的最终表现 ---

--- 在测试集上评估最终模型 ---
测试集上的准确率: 0.9074🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟🌟

项目运行结束。

进程已结束，退出代码为 0
